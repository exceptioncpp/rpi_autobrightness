# üí° Raspberry Pi HDMI Auto-Brightness

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —è—Ä–∫–æ—Å—Ç–∏ HDMI-–¥–∏—Å–ø–ª–µ—è –Ω–∞ Raspberry Pi 3 Model B —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

- BH1750 (–¥–∞—Ç—á–∏–∫ –æ—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ I2C)
- `ddcutil` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —è—Ä–∫–æ—Å—Ç—å—é –º–æ–Ω–∏—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ DDC/CI
- Python + systemd –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/exceptioncpp/rpi_autobrightness.git
cd rpi_autobrightness
./install.sh
```

---

## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ BH1750 –∫ Raspberry Pi (40-pin GPIO)

- VCC ‚Üí Pin 1 (3.3V)
- GND ‚Üí Pin 6 (GND)
- SDA ‚Üí Pin 3 (GPIO2 / SDA1)
- SCL ‚Üí Pin 5 (GPIO3 / SCL1)

```
Raspberry Pi 3 B 40-pin GPIO Header
+-----+-----+----------+------+---+---Pi 3 B---+---+------+----------+-----+-----+
| BCM | wPi |   Name   | Mode | V | Physical  | V | Mode | Name     | wPi | BCM |
+-----+-----+----------+------+---+----++----+---+------+----------+-----+-----+
|     |     |    3.3V  |      |   |  1 || 2  |   |      | 5V       |     |     |
|   2 |  8  |  SDA1    | ALT0 | 1 |  3 || 4  |   |      | 5V       |     |     |
|   3 |  9  |  SCL1    | ALT0 | 1 |  5 || 6  | 0 |      | GND      |     |     |
|     ... (—Å–æ–∫—Ä–∞—â–µ–Ω–æ) ...
```

---

## ‚öôÔ∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

- –°—á–∏—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Å–≤–µ—â—ë–Ω–Ω–æ—Å—Ç–∏ (lux) –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- –í—ã—á–∏—Å–ª—è–µ—Ç —Ü–µ–ª–µ–≤—É—é —è—Ä–∫–æ—Å—Ç—å –≤ % (–ø–æ –∫—Ä–∏–≤–æ–π)
- –ü–ª–∞–≤–Ω–æ –º–µ–Ω—è–µ—Ç —è—Ä–∫–æ—Å—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∞ —à–∞–≥–∞–º–∏ –ø–æ 2% —Å –∑–∞–¥–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–∞–∂–¥—ã–µ 200 –º—Å)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `systemd` —Å–µ—Ä–≤–∏—Å
- –ï—Å—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—â–∏–π —Å–µ—Ä–≤–∏—Å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞

---

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É `i2c`:
  ```bash
  sudo usermod -aG i2c $USER
  ```

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –Ω–∞ `ddcutil`:
  ```bash
  echo 'pi ALL=NOPASSWD: /bin/systemctl restart autobrightness' | sudo tee /etc/sudoers.d/autobrightness
  sudo chmod 440 /etc/sudoers.d/autobrightness
  ```

- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤:
  ```bash
  echo none | sudo tee /sys/class/leds/led0/trigger
  echo 0    | sudo tee /sys/class/leds/led1/brightness
  ```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
i2cdetect -y 1   # –¥–ª—è Raspberry Pi, BH1750 –æ–±—ã—á–Ω–æ –Ω–∞ 0x23
ddcutil detect   # –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∞
journalctl -u autobrightness -f  # –ª–æ–≥ –∞–≤—Ç–æ—Å–∫—Ä–∏–ø—Ç–∞
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

- `autobrightness.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
- `watch-autobrightness.sh` ‚Äî –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- `install.sh` ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, systemd, –ø—Ä–∞–≤ –∏ LED
